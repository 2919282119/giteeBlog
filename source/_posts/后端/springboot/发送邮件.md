---
title: 发送邮件
tags: 
- 后端
- springboot
categories: 
---
## 1.引入依赖
```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-mail</artifactId>
</dependency>

```
## 2.配置文件
```yaml
spring:
    mail:
        host: smtp.163.com
        port: 465
        username: haogerdashuaibi666@163.com
        nickname: 阿飞
        password: HCPEWNLGUOEBNXIJ
        default-encoding: utf-8
        properties:
            mail:
                smtp:
                socketFactoryClass: javax.net.ssl.SSLSocketFactory
                debug: true
        # 163邮箱使用的是smtps协议,qq邮箱不需要配置这个（默认是smtp）
        protocol:  smtps 
        
```
### 3.新建一个邮件实体类
本来是想新建一个工具类，但是工具类里的方法是静态方法，静态方法里不能使用非静态的变量，好像会冲突
```java
@Component
public class SimpleMail {
    @Autowired
    private JavaMailSender javaMailSender;
    @Value("${spring.mail.username}")
    private String username;
    @Value("${spring.mail.nickname}")
    private String nickname;
    public void sendEmail(String to, String subject, String content) {
        SimpleMailMessage message = new SimpleMailMessage();
        // 设置邮件主题
        message.setSubject(subject);
        // 设置邮件发送者，昵称+<邮箱地址>
        message.setFrom(nickname+'<'+username+'>');
        // 设置邮件接收者，可以有多个接收者，多个接受者参数需要数组形式
        message.setTo(to);
        // 设置邮件发送日期
        message.setSentDate(new Date());
        // 设置邮件的正文
        message.setText(content);
        // 发送邮件
        javaMailSender.send(message);
     }
}

```

### 可能会有延时操作的需求
springboot中如果需要延时操作，需要给启动类加上@EnableScheduling注解
```java
@Autowired
    private TaskScheduler taskScheduler;
taskScheduler.schedule(() ->{
    //延时操作
},new Date(System.currentTimeMillis()+1000*60*60));

```
